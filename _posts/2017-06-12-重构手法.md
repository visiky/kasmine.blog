---
layout: post
title: é‡æ„æ‰‹æ³•
header-img: post-bg-02.jpg
# tags: [é‡æ„, test]
# category: è¯»ä¹¦ç¬”è®°
---

1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—
1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—
1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—
1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—
1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—
1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—1000å­—


ä¸‹é¢é€šè¿‡è¿™ä¸‹é¢çš„å‡ æ®µä»£ç æŒ‡å‡ºä»£ç åç—‡çŠ¶ï¼Œä»¥åŠè§£å†³æ–¹æ¡ˆï¼Œæ•´ç†å‡ºé‡æ„çš„æ‰‹æ³•
 
# å‡½æ•°é‡æ„
 
## æç‚¼å‡½æ•°
 
 > Extract Methodï¼šæŠŠä¸€æ®µä»£ç ä»åŸå…ˆå‡½æ•°ä¸­æå–å‡ºæ¥ï¼Œæ”¾è¿›ä¸€ä¸ªå•ç‹¬å‡½æ•°ä¸­ã€‚è¿™ä¸Inline Methodç›¸åï¼šå°†ä¸€ä¸ªå‡½æ•°è°ƒç”¨åŠ¨ä½œæ›¿æ¢ä¸ºè¯¥å‡½æ•°æœ¬ä½“ã€‚
 
 ```
 class MyCustomer {
 
    constructor(name, orders) {
        this.name = name;
        this.orders = orders;
    }
    
    printOwing() {
        
        // print banner
        console.log('***********************************************')
        console.log('*********       Custome Owes       ************')
        console.log('***********************************************')
   
        var outstanding = 0
        for (var i = 0; i < orders.length; i++) {
            outstanding += order
        }
        
        // print detail 
        console.log(`name: ${this.name}`)
        console.log(`amount: ${outstanding}`)
    }
}
```
 
- ç°è±¡ï¼šä¸€æ®µä»£ç å¯ä»¥è¢«ç»„ç»‡åœ¨ä¸€èµ·å¹¶ç‹¬ç«‹å‡ºæ¥
- è§£å†³æ–¹æ¡ˆï¼šå°†è¿™æ®µä»£ç æ”¾è¿›ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ä¸­ï¼Œå¹¶è®©å‡½æ•°åç§°è§£é‡Šè¯¥å‡½æ•°çš„ç”¨é€”

```
class MyCustomer {
    
    /**
     *
     * @param {string} name åå­—
     * @param {Array} orders è®¢å•
     */
    constructor(name, orders) {
        this.name = name;
        this.orders = orders;
    }
    
    printOwing() {
        this.printBanner()
        this.printDetail(this.getOutstanding())
    }
    
    printBanner() {
        // print banner
        console.log('***********************************************')
        console.log('*********       Custome Owes       ************')
        console.log('***********************************************')
    }
    
    printDetail(outstanding) {
        // print detail
        console.log(`name: ${this.name}`)
        console.log(`amount: ${outstanding}`)
    }
    
    getOutstanding() {
        var result = 0
        for (var i = 0; i < orders.length; i++) {
            result += order
        }
        return result
    }
}
```


## å¼•å…¥è§£é‡Šæ€§å˜é‡

> Introduce Explaining Variable

```
class Product {

    constructor(quantity, itemPrice) {
        this.quantity = quantity
        this.itemPrice = itemPrice
    }
    
    getPrice() {
        return this.quantity * this.itemPrice - max(0, this.quantity - 500) * this.itemPrice * 0.05 + min(this.quantity * this.itemPrice * 0.1, 100)
    }
}
```

- ç°è±¡ï¼šå‡½æ•°ä¸­å«æœ‰ä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼
- è§£å†³æ–¹æ¡ˆï¼šå°†å¤æ‚è¡¨è¾¾å¼ï¼ˆæˆ–å…¶ä¸­ä¸€éƒ¨åˆ†ï¼‰çš„ç»“æœæ”¾è¿›ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œä»¥æ­¤å˜é‡åç§°æ¥è§£é‡Šè¡¨è¾¾å¼ç”¨é€”

```
class Product {

    constructor(quantity, itemPrice) {
        this.quantity = quantity
        this.itemPrice = itemPrice
    }
    
    getPrice() {
        let basePrice = this.quantity * this.itemPrice                                     // åŸºç¡€ä»·æ ¼
        let quantityDiscount = max(0, this.quantity - 500) * this.itemPrice * 0.05         // æŠ˜æ‰£
        let shipping = min(basePrice * 0.1, 100)                                 // è¿è´¹
        return basePrice - quantityDiscount + shipping
    }
}
```

## ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡

> Replace Temp with Query

ç»§ç»­é‡æ„ä¸Šé¢çš„ä¾‹å­
```
class Product {

    constructor(quantity, itemPrice) {
        this.quantity = quantity
        this.itemPrice = itemPrice
    }

    getPrice() {
        return basePrice() - quantityDiscount() + shipping()
    }
    
    basePrice() {
        return this.quantity * this.itemPrice
    }
    
    quantityDiscount() {
        return max(0, this.quantity - 500) * this.itemPrice * 0.05         // æŠ˜æ‰£
    }
    
    shipping() {
        return min(basePrice() * 0.1, 100)                      // è¿è´¹
    }
}
```


## ç§»é™¤å¯¹å‚æ•°çš„èµ‹å€¼

> Remove Assignments to Parameters

```
function discount( inputVal, quantity, yearToDate) {
    if (inputVal > 50 ) {
        inputVal -= 2
    }
    
    if (quantity > 100) {
        inputVal -= 1
    }
    
    if (yearToDate > 5000 ) {
        inputVal -= 3
    }
    return inputVal
}

```

* ç°è±¡ï¼šä»£ç å¯¹ä¸€ä¸ªå‡½æ•°çš„å‚æ•°è¿›è¡Œäº†èµ‹å€¼
* è§£å†³æ–¹æ¡ˆï¼šä»¥ä¸€ä¸ªä¸´æ—¶å˜é‡å–ä»£è¯¥å‚æ•°çš„ä½ç½®

```
function discountOver(inputVal, quantity, yearToDate) {
    var result = inputVal
    
    if (inputVal > 50 ) {
        result -= 2
    }
    
    if (quantity > 100 ) {
        result -= 1
    }
    
    if (yearToDate > 5000) {
        result -= 3
    }
    return result
}
```

## å°†æŸ¥è¯¢å‡½æ•°å’Œä¿®æ”¹å‡½æ•°åˆ†ç¦»

```


```


* ç°è±¡ï¼šæŸä¸ªå‡½æ•°æ—¢è¿”å›å¯¹è±¡çŠ¶æ€å€¼ï¼Œåˆä¿®æ”¹å¯¹è±¡çŠ¶æ€
* è§£å†³æ–¹æ¡ˆï¼šå»ºç«‹ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªè´Ÿè´£æŸ¥è¯¢ï¼Œä¸€ä¸ªè´Ÿè´£ä¿®æ”¹ï¼ˆå¯ä»¥ç†è§£ä¸ºæœ‰å‰¯ä½œç”¨å’Œæ— å‰¯ä½œç”¨çš„å·®å¼‚ï¼‰




# ç»§æ‰¿å…³ç³»é‡æ„

## æ„é€ æ¨¡æ¿å‡½æ•°

> Form Template Method 

```
class Subclass1 {
    
    calculate() {
        let a = 10 * 90 - 2
        let b = 10 / 5 + 30
        return a + b
    }
}

class Subclass2 {
    calculate() {
        let a = 4 * 5 - 6
        let b = 1 / 5 + 2
        return a + b    // å‡è®¾a+bä¸ºè¾ƒä¸ºå¤æ‚çš„ä¸šåŠ¡é€»è¾‘æ¨¡æ¿
    }
}

const log = function(msg) {
    console.log(msg);
}

let sub1 = new Subclass1()
log(sub1.calculate())
let sub2 = new Subclass2()
log(sub2.calculate())
```

* ç°è±¡ï¼šä¸åŒç±»ä¸­çš„æ–¹æ³•ä¸­å¤§ä½“æ­¥éª¤ç›¸åŒï¼Œå…·ä½“ç»†èŠ‚ä¸åŒ
* è§£å†³æ–¹æ¡ˆï¼šå°†ç»†èŠ‚è¿›è¡Œå°è£…ï¼Œå°†æ­¥éª¤æå–åˆ°çˆ¶ç±»ä¸­

```
class SuperClass {
    calculate() {
        return this.getA() + this.getB()
    }

    getA() {
        return 0
    }

    getB() {
        return 0
    }
}

class Subclass1 extends SuperClass {

    getA() {
        return 10 * 90 - 2
    }

    getB() {
        return 10 / 5 + 30
    }
}

class Subclass2 extends SuperClass {

    getA() {
        return 4 * 5 - 6
    }

    getB() {
        return 1 / 5 + 2
    }
}
```

## å­—æ®µä¸Šç§»

> Pull Up Field 

```
class MySuperClass0 {
    
}

class SubClass1 extends MySuperClass0 {
    constructor() {
        this.a = 0;
        this.type = 'sub1';
        this.sub1 = 'xx';
    }
}

class SubClass2 extends MySuperClass0 {
    constructor() {
        this.a = 0;
        this.type = 'sub1';
        this.sub2 = 'xx';
    }
}
```

- ç°è±¡ï¼šä¸¤ä¸ªå­ç±»æ‹¥æœ‰ç›¸åŒçš„å­—æ®µ
- è§£å†³æ–¹æ¡ˆï¼šå°†å­—æ®µç§»åˆ°è¶…ç±»ä¸­

```
class MySuperClass {
    constructor(type) {
        this.a = 0;
        this.type = type;
    }
}

class SubClass01 extends MySuperClass {
    constructor() {
        super('sub1');
        this.sub1 = 'xx';
    }
}

class SubClass02 extends MySuperClass {
    constructor() {
        super('sub2');
        this.sub2 = 'xx';
    }
}
```

### æ‰©å±•

- **Pull Up Constructor Body (å°†æ„é€ å™¨ä¸Šç§»)**
	- ç°è±¡ï¼šä¸¤ä¸ªå­ç±»æ‹¥æœ‰ç›¸åŒçš„å­—æ®µå‡½æ•°
	- è§£å†³æ–¹æ¡ˆï¼šå°†å‡½æ•°ç§»åˆ°è¶…ç±»ä¸­

- **Pull Down Field (å­—æ®µä¸‹ç§»)**
	- ç°è±¡ï¼šçˆ¶ç±»ä¸­çš„æŸä¸€ä¸ªå­—æ®µåªæœ‰ä¸€ä¸ªæŸä¸€ä¸ªå­ç±»ä½¿ç”¨åˆ°
 	- è§£å†³æ–¹æ¡ˆï¼šå°†è¯¥å­—æ®µç§»åˆ°è¯¥å­ç±»ä¸­

# ç±»é‡æ„

## æç‚¼ç±»

> Extract Class

```
class Employee {

    /**
     *
     * @param {string} name -
     * @param {string} officeAreaCode -
     * @param {string} officeNumber -
     */
    constructor(name, officeAreaCode, officeNumber) {
        this.name = name
        this.officeAreaCode = officeAreaCode
        this.officeNumber = officeNumber
    }
}
```

* ç°è±¡ï¼šæŸä¸ªç±»åšäº†åº”è¯¥ç”±ï¼Œä¸¤ä¸ªç±»åšçš„äº‹æƒ…
* è§£å†³æ–¹æ¡ˆï¼šåˆ›å»ºä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ä¸­ã€‚

```
class TelephoneNumber {
    // var areaCode: String
    // var number: String
    
    constructor(areaCode, number) {
        this.areaCode = areaCode
        this.number = number
    }
}

class Person {
    // let name: String
    // var officeTelephoneNumber: TelephoneNumber
   
    constructor(name, officeTelephoneNumber) {
        this.name = name
        this.officeTelephoneNumber = officeTelephoneNumber
    }
    
    getOfficeAreaCode() {
        return officeTelephoneNumber.areaCode
    }
    
    getOfficeNumber() {
        return officeTelephoneNumber.number
    }
}
```

## éšè—â€œå§”æ‰˜å…³ç³»â€

> Hide Delegate

```
class Department {

    /**
     *
     * @param {string} chargeCode - éƒ¨é—¨ä»£ç 
     * @param {Object} manager - Object.shape<People> ç»ç†
     */
    constructor(chargeCode, manager) {
        this.chargeCode = chargeCode
        this.manager = manager
    }
}

class People {

    /**
     *
     * @param {string} name -
     * @param {Object} department  - Object.shape<Department> æ‰€åœ¨éƒ¨é—¨
     */
    constructor (name, department) {
        this.name = name
        this.department = department
    }
}

let scotterManager = new People('Scott', new Department ('Creditease', null))
let zeluLi = new People( 'ZeluLi', new Department('Creditease', scotterManager))

console.log(zeluLi.department.manager.name) // Scott
console.log(scotterManager.department.manager.name) // Cannot read property 'name' of null - å‡ºç°å¼‚å¸¸
```

* ç°è±¡ï¼šå®¢æˆ·é€šè¿‡ä¸€ä¸ªå§”æ‰˜ç±»æ¥è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡
* è§£å†³æ–¹æ¡ˆï¼šåœ¨æœåŠ¡ç±»ä¸Šå»ºç«‹å®¢æˆ·æ‰€éœ€çš„æ‰€æœ‰å‡½æ•°ï¼Œç”¨ä»¥éšè—å§”æ‰˜å…³ç³»

```
class Department {

    /**
     *
     * @param {string} chargeCode - éƒ¨é—¨ä»£ç 
     * @param {Object} manager - Object.shape<People> ç»ç†
     */
    constructor(chargeCode, manager) {
        this.chargeCode = chargeCode
        this.manager = manager
    }
}

class People {

    constructor (name, department) {
        this.name = name || 'no sucn People'
        this.department = department
    }

    getManager() {
         return this.department.manager || new People();
     }
}

let scotterManager = new People('Scott', new Department ('Creditease', null))
let zeluLi = new People( 'ZeluLi', new Department('Creditease', scotterManager))

console.log(zeluLi.getManager().name) // Scott
console.log(scotterManager.getManager().name) // no sucn People
```

## Move Method

```
const NEW_BOOK = 0,
    OLD_BOOK = 1,
    CHIDREN_BOOK = 2;


class Book {
 
    constructor(bookCode, bookName) {
        this.bookCode = bookCode
        this.bookName = bookName
    }
}

class BookCustomer {

    constructor(name, isVip) {
        this.name = name;
        this.isVip = isVip;
        this.books = new Array();
    }
    
    charge() {
        var result = 0
        
        for (let i = 0; i < this.books.length; i++) {
        
            let singel = 0, book = this.books[i];
            switch (book.bookCode) {
                case NEW_BOOK:
                    singel += 10
                    break;
                case OLD_BOOK:
                    singel += 5
                    break;
                case CHIDREN_BOOK:
                    singel += 3
                    break;
                default:
                    single += 0;
                    break;
            }
            result += singel;
        };
        
        if (this.isVip) {
            result *= 0.7
        } else {
            result *= 0.9
        }
        
        return result
    }
}

let bookCustomer = new BookCustomer( 'ZeluLi', true)

bookCustomer.books.push(new Book( 0, 'ã€ŠBook Name 1ã€‹'))
bookCustomer.books.push(new Book(1, 'ã€ŠBook Name 2ã€‹'))
bookCustomer.books.push(new Book( 2, 'ã€ŠBook Name 3ã€‹'))

console.log(bookCustomer.charge())
```

-Â  ç°è±¡ï¼š
-Â  è§£å†³æ–¹æ¡ˆï¼š

```
class Book {
 
    constructor(bookCode, bookName) {
        this.bookCode = bookCode
        this.bookName = bookName
    }
    charge() {
        var result = 0
        switch (this.bookCode ) {
            case BOOK_TYPE.NEW_BOOK:
                result += 10;
                break;
            case BOOK_TYPE.OLD_BOOK:
                result += 5;
                break;
            case BOOK_TYPE.CHIDREN_BOOK:
                result += 3;
                break;
            default:
                break;
        }
        return result
    }
}


class BookCustomer {
    
    constructor({name, isVip}) {
        this.name = name;
        this.isVip = isVip;
        this.books = new Array();
    }
    
    charge() {
        return this.getVipChage(this.getBaseCharge())
    }
    
    getBaseCharge() {
        var result = 0
        for (let i = 0; i < this.books.length; i++) {
            let book = this.books[i];
            result += book.charge()
        }
        return result
    }
    
    getVipChage(baseMoney) {
        if (this.isVip) {
            return baseMoney * 0.7
        } else {
            return baseMoney * 0.9
        }
    }
}

let bookCustomer = new BookCustomer({name: 'ZeluLi', isVip: true})

bookCustomer.books.push(new Book( 0, 'ã€ŠBook Name 1ã€‹'))
bookCustomer.books.push(new Book( 1, 'ã€ŠBook Name 2ã€‹'))
bookCustomer.books.push(new Book(  2, 'ã€ŠBook Name 3ã€‹'))

console.log(bookCustomer.charge())
```

# æ•°æ®é‡æ„

## å°è£…é›†åˆ

> Encapsulate Collection

```
class LibraryBook {
  
    constructor(name) {
        this.name = name
    }
    
    getName() {
        return this.name
    }
}

class Lender {

    constructor(name) {
        this.name = name
        this.lendBooks = new Array();
    }
    
    getName() {
        return this.name
    }
    
    setLendBooks(books) {
        this.lendBooks = books
    }
    
    getLendBooks() {
        return this.lendBooks
    }
}


// å…ˆåˆ›å»ºä¸€ä¸ªä¹¦ç±æ•°ç»„
var books = new Array();
// æ·»åŠ è¦å€Ÿçš„ä¹¦ç±
books.push(new LibraryBook('ã€Šé›ªç¢§åŠ ç›ã€‹'))
books.push(new LibraryBook( 'ã€Šæ ¼æ—ç«¥è¯ã€‹'))
books.push(new LibraryBook('ã€Šæ™ºæ…§æ„æ—ã€‹'))

// åˆ›å»ºå€Ÿä¹¦äºº
let lender = new Lender('ZeluLi')
lender.setLendBooks(books)

// è·å–æ‰€å€Ÿä¹¦ç±
var myBooks = lender.getLendBooks()

console.log(lender.getLendBooks());

// å¯¹ä¹¦ç±æ•°ç»„ä¿®æ”¹åå†èµ‹å€¼å›å» - ç§»é™¤ç¬¬ä¸€æœ¬
myBooks.shift();

lender.setLendBooks(myBooks)

console.log(lender.getLendBooks());
```

- ç°è±¡ï¼š
- è§£å†³æ–¹æ¡ˆï¼š

```
class LibraryBook {
  
    constructor(name) {
        this.name = name
    }
    
    getName() {
        return this.name
    }
}

class Lender {

    constructor(name) {
        this.name = name
        this.lendBooks = new Array();
    }
    
    getName() {
        return this.name
    }
    
    
    getLendBooks() {
        return this.lendBooks
    }
    
    // ä¸ºç›¸åº”çš„é›†åˆæ·»åŠ ç›¸åº”çš„æ“ä½œæ–¹æ³•
    addBook(bookName) {
        this.lendBooks.push(new LibraryBook(bookName))
    }
    
    removeBook(bookName) {
        this.lendBooks = this.lendBooks.filter((lendBook)=>{
            if (lendBook.name === bookName) {
                return false;
            }
            return true;
        })
    }
    
    removeAllBooks() {
        this.lendBooks = new Array();
    }
}

var bookLender = new Lender( 'Zeluli')

bookLender.addBook('ã€Šé›ªç¢§åŠ ç›ã€‹')
bookLender.addBook('ã€Šæ ¼æ—ç«¥è¯ã€‹')
bookLender.addBook('ã€Šæ™ºæ…§æ„æ—ã€‹')

bookLender.getLendBooks()
bookLender.removeBook('ã€Šé›ªç¢§åŠ ç›ã€‹')
console.log(bookLender.getLendBooks())
```

## è‡ªå°è£…å­—æ®µ

> Self Encapsulate Field

```
class IntRange {

    constructor(low, high) {
        this.low = low
        this.high = high
    }
    
    grow(factor) {
        this.high *= factor
    }
    
    includes(arg) {
        return arg >= this.low && arg <= this.high
    }
}

// ä¸ºInRangeæ·»åŠ å­ç±»

class CappedRange extends IntRange {

    constructor(low, high, cap) {
        super(low, high)
        this.cap = cap
    }
  
    includes(arg) {
        return arg >= this.low && arg <= Math.min(this.high, this.cap);
    }
}


// æµ‹è¯•ç”¨ä¾‹--------------------------------------------------------------------

const log = function(msg) {
    console.log(msg)
}

function test(capRange) {
    log(capRange.includes(30))
    log(capRange.includes(41))
}

var capRange = new CappedRange(0, 50, 41)
test(capRange)
capRange.high = 40;
test(capRange)
```
- ç°è±¡ï¼šå½“ç›´æ¥è®¿é—®å­—æ®µæ—¶ï¼Œå¢åŠ äº†ä»£ç çš„è€¦åˆåº¦
- è§£å†³æ–¹æ¡ˆï¼š
```
// ä¸ºä¸Šè¿°å­—æ®µæ·»åŠ setterå’Œgetteræ–¹æ³•

class IntRange {
    
    constructor(low, high) {
        this.low = low
        this.high = high
    }
    
    grow(factor) {
        setHigh(this.getHigh() * factor)
    }
    
    includes(arg) {
        return arg >= this.getLow() && arg <= this.getHigh()
    }
    
    setLow(low) {
        this.low = low
    }
    
    getLow() {
        return this.low
    }
    
    setHigh(high) {
        this.high = high
    }
    
    getHigh() {
        return this.high
    }
}

// ä¸ºInRangeæ·»åŠ å­ç±»æ—¶ï¼Œé—´æ¥èµ‹å€¼çš„å¥½å¤„æ‰ä¼šä½“ç°å‡ºæ¥
class CappedRange extends IntRange {

    constructor(low, high, cap) {
        super(low, high)
        this.cap = cap
    }
    
    getCap() {
        return this.cap
    }
    
    getHigh() {
        return Math.min(super.getHigh(), this.getCap())
    }
}

// æµ‹è¯•ç”¨ä¾‹--------------------------------------------------------------------

const log = function(msg) {
    console.log(msg)
}

function test(capRange) {
    log(capRange.getHigh())
    log(capRange.includes(30))
    log(capRange.includes(41))
}

var capRange = new CappedRange(0, 50, 41)
test(capRange)
capRange.setHigh(40)
test(capRange)
```

# æ¡ä»¶è¡¨è¾¾å¼é‡æ„

## åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ

> Consolidate Duplicate Conditional Fragments

```
function totalMoney1(price) {
    let total = 0
    if (price > 1000 ) {
        total = price * 0.8
        console.log(total)
    } else {
        total = price * 0.7
        console.log(total)
    }
}
```

- ç°è±¡ï¼šåœ¨æ¡ä»¶è¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯ä¸Šæœ‰ç€ç›¸åŒçš„ç‰‡æ®µ
- è§£å†³æ–¹æ¡ˆï¼šè¿™æ®µé‡å¤çš„ä»£ç ç§»åŠ¨åˆ°è¡¨è¾¾å¼ä¹‹å¤–

```
function totalMoney1(price) {
    let total = 0
    
    if (price > 1000 ) {
        total = price * 0.8
    } else {
        total = price * 0.7
    }
    
    console.log(total)
}
```

## ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼

> Replace Condition with Polymorphism

```
const BOOK_TYPE = {
    NEW_BOOK: 0,
    OLD_BOOK: 1,
    CHIDREN_BOOK: 2
}

class Book {

    constructor({bookCode, bookName}) {
        this.bookCode = bookCode
        this.bookName = bookName
    }
    charge() {
        var result = 0
        switch (this.bookCode ) {
            case BOOK_TYPE.NEW_BOOK:
                result += 10; // å‡è®¾è¿™é‡Œæ˜¯ä¸€äº›è¶…å¤æ‚çš„è®¡ç®—
                break;
            case BOOK_TYPE.OLD_BOOK:
                result += 5; // å‡è®¾è¿™é‡Œæ˜¯ä¸€äº›è¶…å¤æ‚çš„è®¡ç®—
                break;
            case BOOK_TYPE.CHIDREN_BOOK:
                result += 3; // å‡è®¾è¿™é‡Œæ˜¯ä¸€äº›è¶…å¤æ‚çš„è®¡ç®—
                break;
            default:
                break;
        }
        return result
    }

}

let book = new Book({bookCode: BOOK_TYPE.NEW_BOOK, bookName: 'ã€Šç¦å°”æ‘©æ–¯ã€‹'})
console.log(book.charge())
```

- ç°è±¡ï¼šæ¡ä»¶æ˜¯å¯¹è±¡çš„ç±»å‹ï¼Œæ ¹æ®å¯¹è±¡çš„ç±»å‹è€Œé€‰æ‹©ä¸åŒçš„è¡Œä¸º
- è§£å†³æ–¹æ¡ˆï¼šå°†è¿™ä¸ªæ¡ä»¶è¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯æ”¾è¿›ä¸€ä¸ªå­ç±»çš„è¦†å†™å‡½æ•°ä¸­ï¼Œç„¶åå°†åŸå§‹å‡½æ•°å£°æ˜ä¸ºæŠ½è±¡å‡½æ•°

```
// ä½¿ç”¨å¤šæ€è¿›è¡Œé‡æ„

const NewBook = {
    charge() {
        return 10   // å‡è®¾è¿™é‡Œæ˜¯ä¸€äº›è¶…å¤æ‚çš„è®¡ç®—
    }
}

const OldBook = {
    charge() {
        return 5    // å‡è®¾è¿™é‡Œæ˜¯ä¸€äº›è¶…å¤æ‚çš„è®¡ç®—
    }
}

const ChildrenBook = {
    charge() {
        return 3    // å‡è®¾è¿™é‡Œæ˜¯ä¸€äº›è¶…å¤æ‚çš„è®¡ç®—
    }
}

class Book {
    constructor({bookCode, bookName}) {
        this.bookName = bookName
        this.bookCode = bookCode
        this.price = this.setBookPrice(bookCode)
    }
    
    setBookPrice(bookCode) {
        switch (bookCode) {
            case BOOK_TYPE.NEW_BOOK:
                return NewBook.charge()
            case BOOK_TYPE.OLD_BOOK:
                return OldBook.charge()
            case BOOK_TYPE.CHIDREN_BOOK:
                return ChildrenBook.charge()
            default:
                return 0;
        }

    }
    charge() {
        return this.price
    }

}

let book = new Book({bookCode: BOOK_TYPE.NEW_BOOK, bookName: 'ã€Šç¦å°”æ‘©æ–¯ã€‹'})
console.log(book.charge())
```

## ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿

> Replace Inheritance with Delegation

å‡è®¾è¿™é‡Œæˆ‘ä»¬æœ‰ä¸ªç±»åº“ï¼Œå®ç°äº† Vector å’Œ  Stack è¿™äº›æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”è®© Stack ç±»ç»§æ‰¿ Vector ç±»ã€‚

```
// è¿™é‡ŒæŸäº›æ–¹æ³• å‡è®¾åœ¨Vectorä¸­å·²ç»å®ç°

class Vector {
    
    constructor(){
        // ... å¾ˆå¤šå­—æ®µ
    }
    insertElementAt(ele, index) {
        // ...
    }
    removeElemnetAt(index) {
        // ...
    }
    size() {
        //...
    }
    isEmpty() {

    }
    // å…¶ä»–æ›´å¤šå‡½æ•°æ–¹æ³•
}

class MyStack  {
    constructor(){
        this._vector = new Vector()
    }

    push(obj) {
        this._vector.insertElementAt(ele, 0);
    }

    pop() {
        const result = this._vector.firstElement();
        this._vector.removeElemnetAt(0);
        return result;
    }
    size() {
        return _vector.size();
    }
    isEmpty() {
        return _vector.isEmpty();
    }
}
```
è¿™é‡Œæœ‰ä¸ªè¯´æ˜ï¼šMyStackæœ‰4ä¸ªåŠŸèƒ½ï¼š`push()`ã€`pop()`ã€`size()`ã€`isEmpty()`;å…¶ä¸­åä¸¤è€…ä»VectoråŸºç¡€è€Œæ¥

* ç°è±¡ï¼šå­ç±»åªç”¨åˆ°äº†çˆ¶ç±»çš„æŸäº›æ–¹æ³•ï¼Œæœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•å¹¶æ²¡æœ‰ç»§æ‰¿ä¸”æ²¡æœ‰ç»§æ‰¿çˆ¶ç±»çš„æ•°æ®
* è§£å†³æ–¹æ¡ˆï¼šå°†è¿™ç§ç»§æ‰¿å…³ç³»ä¿®æ”¹æˆå§”æ‰˜ä»£ç†å…³ç³»

```
class MyStack extends Vector {
    constructor(){
        super();
    }

    push(obj) {
        this.insertElementAt(ele, 0);
    }

    pop() {
        const result = this.firstElement();
        this.removeElemnetAt(0);
        return result;
    }
}
```

* ç°è±¡ï¼š - ä½¿ç”¨æ˜¾å¼ä¼ªå¤šæ€ä¼šåœ¨æ‰€æœ‰éœ€è¦ä½¿ç”¨(ä¼ª)å¤šæ€å¼•ç”¨çš„åœ°æ–¹åˆ›å»ºä¸€ä¸ªå‡½æ•°å…³è”ï¼Œè¿™ä¼šæå¤§åœ°å¢åŠ ç»´æŠ¤æˆæœ¬ã€‚
        - æ­¤å¤–ï¼Œç”±äºæ˜¾å¼ä¼ªå¤šæ€å¯ä»¥æ¨¡æ‹Ÿå¤šé‡ç»§æ‰¿ï¼Œæ‰€ä»¥å®ƒä¼šè¿›ä¸€æ­¥å¢åŠ ä»£ç çš„å¤æ‚åº¦å’Œç»´æŠ¤éš¾åº¦ã€‚


## ä»¥ç»§æ‰¿å–ä»£å§”æ‰˜

> Replace Delegation with Inheritance

* ç°è±¡ï¼šä¸¤ä¸ªç±»ä¸ºå§”æ‰˜å…³ç³»ï¼Œå¹¶ç»å¸¸ä¸ºæ¥å£ç¼–å†™è®¸å¤šåŠå…¶ç®€å•çš„å§”æ‰˜å‡½æ•°
* è§£å†³æ–¹æ¡ˆï¼šå°†å§”æ‰˜ç±»ç»§æ‰¿å—æ‰˜ç±»ï¼Œä¸ä¸Šé¢æ­£å¥½ç›¸å

ğŸ¶ é—®é¢˜ æ€æ ·çš„ä¾‹å­å¯ä»¥è¯´æ˜ï¼Œè¿™é‡Œå…¶å®æ¶‰åŠåˆ°äº† ç»§æ‰¿å’Œå§”æ‰˜çš„ä¸€ä¸ªæ–¹æ³•æ¯”è¾ƒ

# æ€è€ƒ

## å¦‚ä½•å¤„ç†æ¦‚æ‹¬å…³ç³»

    - æç‚¼ç»§æ‰¿ä½“ç³»
    - æŠ˜å ç»§æ‰¿ä½“ç³»
    - ä»¥ç»§æ‰¿å–ä»£å§”æ‰˜
    - ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿
    - ä»¥å­—æ®µå–ä»£å­ç±»
    - ä»¥å­ç±»å–ä»£ç±»å‹ç 
    - è‡ªå°è£…å­—æ®µ

## åˆ†ç¦»æ‰‹æ³•