---
layout: post
title: Snap.svg Api æ¡ˆä¾‹å®æˆ˜
categories: [å‰ç«¯æ¯å‘¨æ¸…å•1]
tag: [HTML5,Graphics,SVG]
---

# Element

## Element.attr( )

**å‚æ•° && è¿”å›å€¼**

> @param{obejct}    @returns {Element}

> @param{string}     @retruns {string}

**ä½¿ç”¨**

```js
circle.attr({
    fill: '#000',
    'fill-opacity': 0.4,
    width: "*=2" // prefixed values,
    mask: {Element}
})
```

**æ•ˆæœ**


## Element.pattern(x, y, width, height)

> ä½¿ç”¨é¢„å®šä¹‰çš„å›¾å½¢å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œå¡«å……æˆ–æè¾¹ï¼Œå°±è¦ç”¨åˆ°patternå…ƒç´ ã€‚patternå…ƒç´ è®©é¢„å®šä¹‰å›¾å½¢èƒ½å¤Ÿä»¥å›ºå®šé—´éš”åœ¨xè½´å’Œyè½´ä¸Š**é‡å¤ï¼ˆæˆ–å¹³é“ºï¼‰**ä»è€Œè¦†ç›–è¦æ¶‚è‰²çš„åŒºåŸŸã€‚å…ˆ**ä½¿ç”¨patternå…ƒç´ å®šä¹‰å›¾æ¡ˆ**ï¼Œç„¶ååœ¨ç»™å®šçš„å›¾å½¢å…ƒç´ ä¸Šç”¨å±æ€§fillæˆ–å±æ€§strokeå¼•ç”¨ç”¨æ¥å¡«å……æˆ–æè¾¹çš„å›¾æ¡ˆã€‚

**å‚æ•° && è¿”å›å€¼**

> @return {Element}  // è¿”å›ä¸€ä¸ª[pattern](https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Patterns) å…ƒç´ 


**ç”¨æ³•**

```js
var p = paper.path("M10-5-10,15M15,0,0,15M0-5-20,15").attr({
        fill: "none",
        stroke: "#bada55",
        strokeWidth: 5
    }).pattern(0, 0, 10, 10),
    c = paper.circle(200, 200, 100);
c.attr({
    fill: p
});
```

**æ•ˆæœ**

[CodePen](https://codepen.io/kasmine/pen/ZyvZmV)

**æºç **

```js
 elproto.pattern = elproto.toPattern = function (x, y, width, height) {
        // ğŸ¶ <pattern> éœ€è¦æ”¾åœ¨ <defs> ä¸‹
        var p = make("pattern", getSomeDefs(this)); // åˆ›å»ºpatternå…ƒç´ ï¼Œå¹¶ä¸”è¿½åŠ åœ¨è¯¥svgç”»å¸ƒå…ƒç´ çš„defsä¸‹
        if (x == null) { // å¦‚æœæ²¡æœ‰ä¼ å…¥ åˆ™ä½¿ç”¨ åŸç»“ç‚¹çš„Box å¤§å°
            x = this.getBBox();
        }
        if (is(x, "object") && "x" in x) {
            y = x.y;
            width = x.width;
            height = x.height;
            x = x.x;
        }
        $(p.node, { // ä¸º [pattern](https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/pattern)å…ƒç´ æ·»åŠ å±æ€§
            x: x,
            y: y,
            width: width,
            height: height,
            patternUnits: "userSpaceOnUse",
            id: p.id,
            viewBox: [x, y, width, height].join(" ")
        });
        p.node.appendChild(this.node); // å°†åŸæ¥çš„å›¾æ¡ˆ ç»“ç‚¹ åŒ…è£…åœ¨ patternå…ƒç´ ä¸‹ 
        return p;
    };
```

## Element.getBBox()

**å‚æ•° && è¿”å›å€¼**

> @returns {object}  // ç»™å®šå…ƒç´ çš„è¾¹ç•Œæ¡†æè¿°

```js
{
    cx: number,
    cy: number,
    h: number,
    hieght: number, // height
    path: string, // how to get
    r0: number, // a circle that fully encloses the box è¯‘ï¼šå¯å®Œå…¨å°†å›¾å½¢å…ƒç´ æ‰€åœ¨çŸ©å½¢boxåŒ…ä½çš„åœ†
    r1: number, // the smallest circle
    r2: number, // the largest circle è¯‘ï¼šåŒ…ä½å…ƒç´ çš„æœ€å¤§åœ†
    vb: string, // è§†çª—ç›’å­å‘½ä»¤ -> [x, y, width, height].join(" ")
    w: number, // width
    width: number,
    x2: number, // å³ä¾§ x å€¼
    x: number, // å·¦ä¾§ x å€¼
    y2: number, // åº•è¾¹ç¼˜ y å€¼
    y: number // ä¸Šè¾¹ç¼˜ y å€¼
}
```

**æºç **

- ä¸boxæ¶‰åŠç›¸å…³çš„æ˜¯ `path`

```js
// è·å–ç›’å­ box
function box(x, y, width, height) {
    if (x == null) {
        x = y = width = height = 0;
    }
    if (y == null) {
        y = x.y;
        width = x.width;
        height = x.height;
        x = x.x;
    }
    return {
        x: x,
        y: y,
        width: width,
        w: width,
        height: height,
        h: height,
        x2: x + width,
        y2: y + height,
        cx: x + width / 2,
        cy: y + height / 2,
        r1: Math.min(width, height) / 2,
        r2: Math.max(width, height) / 2,
        r0: Math.sqrt(width * width + height * height) / 2,
        path: rectPath(x, y, width, height),
        vb: [x, y, width, height].join(" ")
    };
} 
```

ä¸ä¹‹ç›¸å…³çš„ Path

- rectPath : `var res = [["M", x, y], ["l", w, 0], ["l", 0, h], ["l", -w, 0], ["z"]];`

**å®æˆ˜**

```js
var s = Snap("#svg");

var circle = s.circle(75, 100, 50);
var g = s.g(circle, s.circle(175, 100, 50));
g.attr({
  fill: 'pink'
});
console.log(g.getBBox())
```
ä¸‹é¢è¿™ä¸ªå›¾å½¢çš„è¾¹æ¡†æè¿°ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿ
![]({{site.imgurl}}/in-post/snap.svg/getBBox-1.png)

æˆ‘ä»¬çœ‹ä¸€ä¸‹è¾“å‡ºç»“æœï¼š
![]({{site.imgurl}}/in-post/snap.svg/getBBox-ouput.png)

ç„¶åï¼Œæˆ‘ä»¬ä»¥ gçš„æè¿°ç¬¦çš„vbåšä¸€ä¸ª rect è¾¹ç•Œ
```js
var vb = g.getBBox().vb.split(' ');
var rect = s.rect(vb[0], vb[1],vb[2],vb[3]);

rect.attr({
  stroke: 'green',
  fillOpacity: 0
})
```
æ•ˆæœå¦‚ä¸‹ï¼š
![]({{site.imgurl}}/in-post/snap.svg/getBBox-2.png)

ğŸ‘‰ [CodePen](https://codepen.io/kasmine/pen/mwXBWM)


## Element.animate(attrs, duration, [easing], [callback])

**å‚æ•° && è¿”å›å€¼**

> @returns {Element} // å½“å‰å…ƒç´ 


# Snap

## Snap( )


**å‚æ•° && è¿”å›å€¼**

> @params{ width, height }  

> @param { DOM }  // svgå…ƒç´ ä¼šè¢«åŒ…è£¹è¿›ä¸€ä¸ª Snap ç»“æ„

> @param {CSS æŸ¥è¯¢é€‰æ‹©å™¨} // ç”¨ querySelector æŸ¥æ‰¾ svgå…ƒç´ 

> @returns {Paper} // ç»˜åˆ¶ä¸€ä¸ªé¢æˆ–è€…åŒ…è£¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„SVGå…ƒç´ 

## Snap.set( )

> Creates a set and fills it with list of arguments. 

**å‚æ•° && è¿”å›å€¼**

> @params {} // None

> @params {array?}   // a list ï¼ˆåˆ—è¡¨å½¢å¼ï¼Œå¯ä»¥éæ•°ç»„

> @returns {object} // New Set object

Snap.setçš„åŸºæœ¬æ ¼å¼ï¼š
![]({{site.imgurl}}/in-post/snap.svg/snap.set.png)

- Set.exclude()
- Set.clear()
- Set.push()
- Set.pop()
- Set.splice()
- Set.forEach()

**ç”¨æ³•**

```js
var r = paper.rect(0, 0, 10, 10),
s1 = Snap.set(), // empty set
s2 = Snap.set(r, paper.circle(100, 100, 20)); // prefilled set
```

[**æºç **](https://github.com/adobe-webplatform/Snap.svg/blob/master/src/set.jsx
)

```js
// Set
var Set = function (items) {
    this.items = [];
    this.bindings = {};
    this.length = 0;
    this.type = "set";
    if (items) {
        for (var i = 0, ii = items.length; i < ii; i++) {
            if (items[i]) {
                this[this.items.length] = this.items[this.items.length] = items[i];
                this.length++;
            }
        }
    }
}
Snap.Set = Set;
Snap.set = function () {
    var set = new Set;
    if (arguments.length) {
        set.push.apply(set, Array.prototype.slice.call(arguments, 0));
    }
    return set;
};
```

- ä½¿ç”¨æ•°ç»„å­˜å‚¨ï¼Œè€Œé Set æ•°æ®ç»“æ„
-ã€€åœ¨`Set.prototype`ä¸Šé‡å†™æ–¹æ³•

## Snap.select( )

> ä½¿ç”¨ CSS é€‰æ‹©å™¨ï¼Œæ‰¾åˆ°ç‰¹å®šå…ƒç´ 




# Paper 

## Paper.el(name, attr)

> Creates an element on paper with a given name and no attributes

**yå‚æ•° && è¿”å›å€¼**

>  @param {string} name // tag name
>  @param {object} attr  //  attributes
>  @returns {Element} // the current element

**ç”¨æ³•**

```js
var c = paper.circle(10, 10, 10); 
// is the same as...
var c = paper.el("circle").attr({
    cx: 10,
    cy: 10,
    r: 10
});
// and the same as
var c = paper.el("circle", {
    cx: 10,
    cy: 10,
    r: 10
});
```
**æºç **

```js
Paper.prototype.el = function (name, attr) {
    var el = make(name, this.node);
    attr && el.attr(attr);
    return el;
};
// ä»¥ rect ä¸ºä¾‹
Paper.prototype.rect = function (x, y, w, h, rx, ry) {
    var attr;
    if (ry == null) {
        ry = rx;
    }
    if (is(x, "object") && x == "[object Object]") {
        attr = x;
    } else if (x != null) {
        attr = {
            x: x,
            y: y,
            width: w,
            height: h
        };
        if (rx != null) {
            attr.rx = rx;
            attr.ry = ry;
        }
    }
    return this.el("rect", attr);
};
```

### Paper.circle(x, y, r)

> è¿”å›å€¼ @returns {object}  - circle å…ƒç´ 

åŒç†ï¼Œè¿˜æœ‰

### Paper.ellipse(x, y, rx, ry)

> è¿”å›å€¼ @returns {object}  - ellipse å…ƒç´ 

### Paper.path([pathString])

> è¿”å›å€¼ @returns {object}  - path å…ƒç´ 

```js
var c = paper.path("M10 10L90 90");
// draw a diagonal line:
// move to 10,10, line to 90,90
```
 <small>**Command**: M, Z, L, H, V, C, S, Q(?), T(?), A(?), R(?)</small>

### Paper.line(x1, y1, x2, y2)

> è¿”å›å€¼ @returns {object}  - line å…ƒç´ 


### Paper.ployline(...)

> è¿”å›å€¼ @returns {object}  - ployline å…ƒç´ 

```js
var p1 = paper.polyline([10, 10, 100, 100]); // ç‚¹çš„æ•°ç»„é›†åˆ
var p2 = paper.polyline(10, 10, 100, 100);  // ç‚¹
```

## Paper.group( )

>  å…ƒç´ gæ˜¯ç”¨æ¥ç»„åˆå¯¹è±¡çš„å®¹å™¨ã€‚æ·»åŠ åˆ°gå…ƒç´ ä¸Šçš„å˜æ¢ä¼šåº”ç”¨åˆ°å…¶æ‰€æœ‰çš„å­å…ƒç´ ä¸Šã€‚æ·»åŠ åˆ°gå…ƒç´ çš„å±æ€§ä¼šè¢«å…¶æ‰€æœ‰çš„å­å…ƒç´ ç»§æ‰¿

**ç”¨æ³•**

```js
var c1 = paper.circle(),
    c2 = paper.rect(),
    g = paper.g(c2, c1);
   //or  g = paper.group(c2, c1); // note that the order of elements is different
//or
var c1 = paper.circle(),
    c2 = paper.rect(),
    g = paper.g();
g.add(c2, c1);
```

**è½¬åŒ–ä¸º HTML**

```html
<g>
    <circle></circle>
    <circle></circle>
</g>
```


**å®æˆ˜**

```js
var smallCircle = paper.circle(100, 150, 50);

var discs = paper.group(smallCircle, paper.circle(200, 150, 50));

discs.attr({
  fill: '#fff'
});
// Snap.set è¿”å›ä¸€ä¸ª set å¯¹è±¡ï¼›
var set = Snap.set(smallCircle, s.circle(200, 150, 50))
var discs = s.group(set);
```

**æºç **

```js
proto.group = proto.g = function (first) {
    var attr,
        el = this.el("g");
    if (arguments.length == 1 && first && !first.type) {
        el.attr(first);
    } else if (arguments.length) {
        el.add(Array.prototype.slice.call(arguments, 0)); // å°†å…ƒç´ è£…å…¥<g>å…ƒç´ å®¹å™¨ä¸­,è¯¦çœ‹ addgroup
    }
    return el;
};

// é™„åŠ 
this.el.add = add2group;

function add2group(list) {
    if (!is(list, "array")) {
        list = Array.prototype.slice.call(arguments, 0); // æ”¯æŒéæ•°ç»„å‚æ•°
    }
    var i = 0,
        j = 0,
        node = this.node;
    while (this[i]) delete this[i++]; //  TODO:
    for (i = 0; i < list.length; i++) {
        if (list[i].type == "set") {  // æ”¯æŒ set å‚æ•°
            list[i].forEach(function (el) {
                node.appendChild(el.node);
            });
        } else {
            node.appendChild(list[i].node);
        }
    }
    var children = node.childNodes;
    for (i = 0; i < children.length; i++) {
        this[j++] = wrap(children[i]);
    }
    return this;
}
```

## Paper.gradient(gradient) 

> å…¶ä»–å¯ä»¥å‚è€ƒ MDN [SVG æ¸å˜](https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Gradients)

**å‚æ•° && è¿”å›å€¼**

> @param {string} gradient // æ¸å˜æè¿°ç¬¦
> @returns {object}æ¸å˜å…ƒç´ 

**ç”¨æ³•**

```js
var g = paper.gradient('r()#fff-#000'); // ä»ç™½è‰²åˆ°é»‘è‰²çš„radialGradient
var g = paper.gradient('l(0, 0, 1, 1)#000-#f00-#fff');

circle.attr({fill: "R(150, 150, 100)#fff-#000"}); // cx: 150, cy: 150, r: 100; from #fff to #000

```


**å®æˆ˜**

```js
var s = Snap('#svg');
// Linear gradient
// absolute from (0, 0) to (100, 100), from black through red at 25% to white:
var g = paper.gradient("L(0, 0, 100, 100)#000-#f00:25-#fff");
s.rect(0, 0, 100, 100).attr({ fill: g });
```
**æ•ˆæœ**

![]({{site.imgurl}}/in-post/snap.svg/paper.gradient.png)

**åˆ†æ**

äº§ç”Ÿçš„HTMLä»£ç å¦‚ä¸‹ï¼š

![]({{site.imgurl}}/in-post/snap.svg/paper.gradient-1.png)


# æ³¨å…¥æ’ä»¶çš„æ–¹å¼ 

* Snap.plugin
[ method ]
* Let you write plugins. You pass in a function with five arguments, like this:

```js
| Snap.plugin(function (Snap, Element, Paper, global, Fragment) {
|     Snap.newmethod = function () {};
|     Element.prototype.newmethod = function () {};
|     Paper.prototype.newmethod = function () {};
| });
```
* Inside the function you have access to all main objects (and their
* prototypes). This allow you to extend anything you want.

```js
/*
*  @params {function} f  // your plugin body
*/
Snap.plugin = function (f) {
    f(Snap, Element, Paper, global, Fragment);
};
```






<style>
blockquote p {
    font-style: normal;
}
</style>